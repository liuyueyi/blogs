<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="报警系统QuickAlarm之报警执行器的设计与实现"/>




  <meta name="keywords" content="Java,SPI,QuickAlarm," />





  <link rel="alternate" href="/hexblog/atom.xml" title="Z+ | Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/hexblog/favicon.ico?v=1.1" />



<link rel="canonical" href="https://zbang.online/hexblog/2018/02/09/报警系统QuickAlarm之报警执行器的设计与实现/"/>


<meta name="description" content="根据前面一篇总纲的博文，将整体结构划分为了四大块，本文则主要目标集中在第一块，报警执行器（AlarmExecute）的设计与加载上了 主要的关注点无外乎 定义-》加载-》实现逻辑三块了：  AlarmExecute 的接口定义 如何加载用户自定义的AlarmExecute AlarmExecute的内部实现">
<meta name="keywords" content="Java,SPI,QuickAlarm">
<meta property="og:type" content="article">
<meta property="og:title" content="报警系统QuickAlarm之报警执行器的设计与实现">
<meta property="og:url" content="https://zbang.online/hexblog/2018/02/09/报警系统QuickAlarm之报警执行器的设计与实现/index.html">
<meta property="og:site_name" content="Z+ | Blog">
<meta property="og:description" content="根据前面一篇总纲的博文，将整体结构划分为了四大块，本文则主要目标集中在第一块，报警执行器（AlarmExecute）的设计与加载上了 主要的关注点无外乎 定义-》加载-》实现逻辑三块了：  AlarmExecute 的接口定义 如何加载用户自定义的AlarmExecute AlarmExecute的内部实现">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://s17.mogucdn.com/mlcdn/c45406/180209_74fic633aebgh5dgfhid2fiiggc99_1220x480.png">
<meta property="og:updated_time" content="2018-02-09T14:12:43.871Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="报警系统QuickAlarm之报警执行器的设计与实现">
<meta name="twitter:description" content="根据前面一篇总纲的博文，将整体结构划分为了四大块，本文则主要目标集中在第一块，报警执行器（AlarmExecute）的设计与加载上了 主要的关注点无外乎 定义-》加载-》实现逻辑三块了：  AlarmExecute 的接口定义 如何加载用户自定义的AlarmExecute AlarmExecute的内部实现">
<meta name="twitter:image" content="https://s17.mogucdn.com/mlcdn/c45406/180209_74fic633aebgh5dgfhid2fiiggc99_1220x480.png">


<link rel="stylesheet" type="text/css" href="/hexblog/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> 报警系统QuickAlarm之报警执行器的设计与实现 - Z+ | Blog </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/hexblog/." class="logo">Z+ | Blog</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/hexblog/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/hexblog/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">



    <header class="post-header">
      <h1 class="post-title">
        
          报警系统QuickAlarm之报警执行器的设计与实现
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          <i class="fa fa-calendar"></i>
          2018-02-09
          
              | <i class="fa fa-folder"></i>
              
                - <a href="/hexblog/categories/Java/">Java</a>
              
                - <a href="/hexblog/categories/Java/QuickAlarm/">QuickAlarm</a>
              
          
        </span>

      </div>
    </header>



    
            <div class="post-content">
            <p>根据前面一篇总纲的博文，将整体结构划分为了四大块，本文则主要目标集中在第一块，报警执行器（AlarmExecute）的设计与加载上了</p>
<p>主要的关注点无外乎 定义-》加载-》实现逻辑三块了：</p>
<ul>
<li>AlarmExecute 的接口定义</li>
<li>如何加载用户自定义的AlarmExecute</li>
<li>AlarmExecute的内部实现</li>
</ul>
<a id="more"></a>
<h2 id="I-AlarmExecute接口定义"><a href="#I-AlarmExecute接口定义" class="headerlink" title="I. AlarmExecute接口定义"></a>I. AlarmExecute接口定义</h2><p>在定义接口之前，先来根据几个问题来加深下这个概念的理解：</p>
<h3 id="1-基础知识"><a href="#1-基础知识" class="headerlink" title="1. 基础知识"></a>1. 基础知识</h3><ol>
<li>说一下这个报警执行器到底是干嘛的？</li>
</ol>
<ul>
<li>执行具体的报警逻辑（感觉说了依据废话）</li>
<li>因此不同的报警方式，可以选择不同的实现，这个强业务关联的逻辑可以交由适用方自己来把控</li>
</ul>
<ol>
<li>多个alarmExecute之间如何区分？</li>
</ol>
<ul>
<li>给一个类似身份证的标识，将标识与alarmExecute绑定，则可以报警规则中，用这个标识来表示对应的报警执行器</li>
<li>标识要求全局唯一，否则就没法找到对应的执行器</li>
</ul>
<h3 id="2-接口定义"><a href="#2-接口定义" class="headerlink" title="2. 接口定义"></a>2. 接口定义</h3><p>根据上面的基础知识，那么很容易给出接口的定义了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IExecute</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 报警的具体实现</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> users 报警用户，支持批量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> title 报警信息的title</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg   报警的主题信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendMsg</span><span class="params">(List&lt;String&gt; users, String title, String msg)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取报警单元唯一标识</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> name  要求全局唯一</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ExecuteNameGenerator.genExecuteName(<span class="keyword">this</span>.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第一个方法<code>sendMsg</code>也就是需要使用者来实现的具体执行报警代码的核心模块了，比较清晰，其中用户是列表，因此，支持同时报警给多个用户（但是报警内容都是相同的）</li>
<li>第二个方法<code>getName</code>表示获取标识，默认给了一个实现，规则如下<ul>
<li>获取类的 SimpleName</li>
<li>干掉类名后面的 <code>Execute</code> （如果不是以这个结尾的就不需要了）</li>
<li>剩下的全部转大写</li>
<li>实例： <code>SmsExecute -&gt; SMS;  LogExecute -&gt; LOG;</code></li>
</ul>
</li>
</ul>
<h3 id="3-额外说明"><a href="#3-额外说明" class="headerlink" title="3. 额外说明"></a>3. 额外说明</h3><p>上面接口定义中的<code>sendMsg</code>中，支持给多个用户发送报警信息，如果要求每个报警信息都不同，比如最常见的是:</p>
<ul>
<li>发送一段文本，其中通知人地方根据报警人来替换，其他的不变</li>
</ul>
<p>当然这样的场景完全可以自己在实现中来做</p>
<ul>
<li>传入的content作为一个话术模板</li>
<li>然后利用 String#format() 来实现参数代替</li>
</ul>
<p>当然更激进一点就是，穿进来的title或者content作为一个key，然后我可以通过这个key，到其他的地方（如db，缓存等）获取报警内容，甚至我连传进来的报警人都不care，直接从其他地方来获取</p>
<p>简单来说，这个实现委托给用户自己实现，你完全可以随意的控制，做任何你想做的事情</p>
<h2 id="II-AlarmExecute的加载"><a href="#II-AlarmExecute的加载" class="headerlink" title="II. AlarmExecute的加载"></a>II. AlarmExecute的加载</h2><h3 id="1-问题分析"><a href="#1-问题分析" class="headerlink" title="1. 问题分析"></a>1. 问题分析</h3><p>加载AlarmExecut，貌似没有什么特别复杂的东西，一般的思路是创建一个简单工厂类，然后实例化对应的Executor返回，（再多一点确保只有一个实例对象，加以缓存）</p>
<p><strong>这样有什么问题？</strong></p>
<p>很简单的实现，但是我们需要加载用户自定义的执行器，要怎么支持呢？</p>
<p><strong>几种可行的解决手段</strong></p>
<h4 id="1-开放一个注册接口"><a href="#1-开放一个注册接口" class="headerlink" title="1. 开放一个注册接口"></a>1. 开放一个注册接口</h4><p>这个可算是最容易想到的了，直接让用户把自己的Executor实例，主动的扔进来</p>
<h4 id="2-抽象工厂"><a href="#2-抽象工厂" class="headerlink" title="2. 抽象工厂"></a>2. 抽象工厂</h4><p>将前面说的简单工厂，改成抽象工厂类，让后具体的加载委托给用户自己来做</p>
<h4 id="3-借助Spring容器来加载"><a href="#3-借助Spring容器来加载" class="headerlink" title="3. 借助Spring容器来加载"></a>3. 借助Spring容器来加载</h4><p>如果所有的AlarmExecute都委托给Spring容器来管理，那么就很简单了，直接通过<code>ApplicationContext#getBean</code>来获取所有的执行器即可</p>
<h4 id="4-SPI加载方式"><a href="#4-SPI加载方式" class="headerlink" title="4. SPI加载方式"></a>4. SPI加载方式</h4><p>通过JDK的spi机制来实现（详细后面来说）</p>
<p>针对上面的几个手段，首先排除掉前面两个，因为不满足我们的设计目标一：</p>
<ul>
<li>简单 （只有报警这个接口进行交互，不需要额外的接口调用）</li>
</ul>
<p>然后也排除掉spring容器，因为我们希望这个东西，可以较独立的被引用到java工程中，后面可以看情况实现一个spring版</p>
<p>从使用来讲，由spring容器来托管的方式，对使用者而言，是最简单，成本最低的，因为不需要额外添加SPI配置</p>
<hr>
<h3 id="2-实现"><a href="#2-实现" class="headerlink" title="2. 实现"></a>2. 实现</h3><p>我们采用SPI方式来实现加载，对于SPI是什么东西，这里不详细展看，有兴趣的童鞋可以看我之前的一个系类博文：<a href="https://my.oschina.net/u/566591/blog/911054" target="_blank" rel="noopener">自定义SPI框架设计</a></p>
<p>实现方式，可说是非常简单了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleExecuteFactory</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, IExecute&gt; cacheMap;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadAlarmExecute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String, IExecute&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Iterator&lt;IExecute&gt; iExecutes = ServiceLoader.load(IExecute.class).iterator();</span><br><span class="line">        IExecute tmp;</span><br><span class="line">        <span class="keyword">while</span> (iExecutes.hasNext()) &#123;</span><br><span class="line">            tmp = iExecutes.next();</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(tmp.getName())) &#123;</span><br><span class="line">                map.put(tmp.getName(), tmp);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> DuplicatedAlarmExecuteDefinedException(</span><br><span class="line">                        <span class="string">"duplicated alarm execute defined!"</span> +</span><br><span class="line">                                <span class="string">"\n"</span> +</span><br><span class="line">                                <span class="string">"&gt;&gt;name:"</span> +</span><br><span class="line">                                tmp.getName() +</span><br><span class="line">                                <span class="string">"&gt;&gt;&gt;clz:"</span> +</span><br><span class="line">                                tmp.getClass() +</span><br><span class="line">                                <span class="string">"&gt;&gt;&gt;clz:"</span> +</span><br><span class="line">                                map.get(tmp.getName())</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cacheMap = map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IExecute <span class="title">getExecute</span><span class="params">(String execute)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cacheMap == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (SimpleExecuteFactory.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cacheMap == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    loadAlarmExecute();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果不存在，则降级为 LogExecute</span></span><br><span class="line">        IExecute e = cacheMap.get(execute);</span><br><span class="line">        <span class="keyword">return</span> e == <span class="keyword">null</span> ? cacheMap.get(LogExecute.NAME) : e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面对外就暴露一个方法，内部比较简单，如果传入标识对应的报警器没有，则返回一个默认的，确保不会因此挂掉</p>
<p>通过SPI加载所有的执行器的逻辑就一行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Iterator&lt;IExecute&gt; iExecutes = ServiceLoader.load(IExecute.class).iterator();</span><br></pre></td></tr></table></figure>
<p>然后需要关注的是循环内部，做了name的唯一性判断，不满足就直接抛出异常了</p>
<h2 id="III-AlarmExecute内部实现"><a href="#III-AlarmExecute内部实现" class="headerlink" title="III. AlarmExecute内部实现"></a>III. AlarmExecute内部实现</h2><p>内部提供了两个基本的报警实现，比较简单</p>
<p>日志报警执行器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 有些报警,不需要立即上报,但是希望计数, 当大量出现时, 用于升级</span></span><br><span class="line"><span class="comment"> * &lt;p/&gt;</span></span><br><span class="line"><span class="comment"> * Created by yihui on 2017/4/28.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogExecute</span> <span class="keyword">implements</span> <span class="title">IExecute</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = ExecuteNameGenerator.genExecuteName(LogExecute.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(<span class="string">"alarm"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMsg</span><span class="params">(List&lt;String&gt; users, String title, String msg)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"Do send msg by &#123;&#125; to user:&#123;&#125;, title: &#123;&#125;, msg: &#123;&#125;"</span>, getName(), users, title, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>空报警执行器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 空报警执行器, 什么都不干</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Created by yihui on 2017/5/12.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NoneExecute</span> <span class="keyword">implements</span> <span class="title">IExecute</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = ExecuteNameGenerator.genExecuteName(NoneExecute.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMsg</span><span class="params">(List&lt;String&gt; users, String title, String msg)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="IV-小结"><a href="#IV-小结" class="headerlink" title="IV. 小结"></a>IV. 小结</h2><p>AlarmExecute 的定义，加载以及实现规则目前都已经完成</p>
<ul>
<li>定义：两个方法，一个执行报警方法，一个返回唯一标识方法</li>
<li>加载：通过SPI方式加载所有定义的alarmExecute</li>
<li>实现：由用户自定义实现<code>IExecute</code>接口，内部逻辑无任务特殊要求，只是需要确保每个executor的name唯一</li>
</ul>
<p>整个系统的第一步已经迈出，但是有个问题就是什么时候，才会来调用 <code>com.hust.hui.alarm.core.execut.SimpleExecuteFactory#getExecute</code> 从而触发执行器的加载呢？</p>
<h2 id="V-其他"><a href="#V-其他" class="headerlink" title="V. 其他"></a>V. 其他</h2><h3 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h3><ul>
<li>项目地址： <a href="https://github.com/liuyueyi/quick-alarm" target="_blank" rel="noopener">Quick-Alarm</a></li>
<li>博客地址： <a href="https://liuyueyi.github.io/hexblog/" target="_blank" rel="noopener">小灰灰Blog</a></li>
</ul>
<h3 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h3><p>尽信书则不如，已上内容，纯属一家之言，因本人能力一般，见解不全，如有问题，欢迎批评指正</p>
<h3 id="扫描关注，java分享"><a href="#扫描关注，java分享" class="headerlink" title="扫描关注，java分享"></a>扫描关注，java分享</h3><p><img src="https://s17.mogucdn.com/mlcdn/c45406/180209_74fic633aebgh5dgfhid2fiiggc99_1220x480.png" alt="QrCode"></p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
      <i class="fa fa-tags"></i>
			<a href="/hexblog/tags/Java/">Java</a>
		  
      <i class="fa fa-tags"></i>
			<a href="/hexblog/tags/SPI/">SPI</a>
		  
      <i class="fa fa-tags"></i>
			<a href="/hexblog/tags/QuickAlarm/">QuickAlarm</a>
		  
		</div>
		

        
        <div style="text-align:center">
        <button id="rewardButton" style="color:red;background-color: #f44336;
    border: none;
    border-radius: 8px;
    color: white;
    padding: 10px 30px;
    text-align: center;
    text-decoration: none;
    font-size: 16px;" 
    disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}"><span>打赏</span></button>
        </div>
        
        <div id="QR" class="row" style="display: none; margin-top: 20px;"><div id="wechat" style="display: inline-block;width:44%;margin-left:6%;text-align:center;">
        <a href="https://s3.mogucdn.com/mlcdn/c45406/180104_50136i33id9e49j1f7k2e219e3ldf_800x798.png" rel="group"><img id="wechat_qr" src="https://s3.mogucdn.com/mlcdn/c45406/180104_50136i33id9e49j1f7k2e219e3ldf_800x798.png" alt="WeChat Pay" style="width:80%;height:80%;max-height:200px;max-width:200px"></a><p style="text-align:center">微信打赏</p></div>
        <div id="alipay" style="display: inline-block;width:44%;text-align:center"><a href="https://s3.mogucdn.com/mlcdn/c45406/180104_0e6afl33b23lacj6ji2d7d060aiak_798x800.png" rel="group" style="width:80%"><img id="alipay_qr" src="https://s3.mogucdn.com/mlcdn/c45406/180104_0e6afl33b23lacj6ji2d7d060aiak_798x800.png" alt="Alipay" style="width:80%;height:80%;max-height:200px;max-width:200px"></a><p style="text-align:center">支付宝打赏</p></div></div>


        
        
  <nav class="post-nav">
    
      <a class="prev" href="/hexblog/2018/02/09/报警系统QuickAlarm之报警规则的设定与加载/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">报警系统QuickAlarm之报警规则的设定与加载</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/hexblog/2018/02/09/报警系统QuickAlarm总纲/">
        <span class="next-text nav-default">报警系统QuickAlarm总纲</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2017 -
    
    2018
    <span class="footer-author">YiHui.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/hexblog/lib/jquery/jquery-3.1.1.min.js"></script>
  

  


<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script type="text/javascript" src="/hexblog/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/hexblog/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
